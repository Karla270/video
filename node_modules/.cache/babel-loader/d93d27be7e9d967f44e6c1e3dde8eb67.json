{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Windows\\\\Desktop\\\\PROYECTOS\\\\Ejemplos\\\\CONFERENCIAS\\\\accelerator-sample-apps-js\\\\react-sample-app\\\\src\\\\App.js\";\n\n/* Let CRA handle linting for sample app */\nimport React, { Component } from 'react';\nimport Spinner from 'react-spinner';\nimport classNames from 'classnames';\nimport AccCore from 'opentok-accelerator-core';\nimport 'opentok-solutions-css';\nimport logo from \"./logo.svg\"; // import config from './config.json';\n\nimport './App.css';\nlet otCore;\nconst otCoreOptions = {\n  credentials: {\n    apiKey: '46876394',\n    sessionId: '1_MX40Njg3NjM5NH5-MTU5NjgwNzk2MTk0Nn5yMzdGcmk3Y3ZyK0YyLzhlckJWc3lYMEx-fg',\n    token: 'T1==cGFydG5lcl9pZD00Njg3NjM5NCZzaWc9YjI4OGE2NGUzZTI1OGVhNjBlZTY2NTAyYWNhNzNiMjI3OTBiODU5MjpzZXNzaW9uX2lkPTFfTVg0ME5qZzNOak01Tkg1LU1UVTVOamd3TnprMk1UazBObjV5TXpkR2NtazNZM1p5SzBZeUx6aGxja0pXYzNsWU1FeC1mZyZjcmVhdGVfdGltZT0xNTk2ODA4MDAxJm5vbmNlPTAuMzE3OTIzNjY3NTYwMzQ4NSZyb2xlPXB1Ymxpc2hlciZleHBpcmVfdGltZT0xNTk2ODk0NDAwJmNvbm5lY3Rpb25fZGF0YT1QUlVFQkElMjBERSUyMFYlQzMlOERERU8lMjBDT05GRVJFTkNJQSZpbml0aWFsX2xheW91dF9jbGFzc19saXN0PQ=='\n  },\n\n  // A container can either be a query selector or an HTML Element\n  streamContainers(pubSub, type, data, stream) {\n    return {\n      publisher: {\n        camera: '#cameraPublisherContainer',\n        screen: '#screenPublisherContainer'\n      },\n      subscriber: {\n        camera: '#cameraSubscriberContainer',\n        screen: '#screenSubscriberContainer'\n      }\n    }[pubSub][type];\n  },\n\n  controlsContainer: '#controls',\n  packages: ['textChat', 'screenSharing', 'annotation'],\n  communication: {\n    callProperties: null // Using default\n\n  },\n  textChat: {\n    name: ['David', 'Paul', 'Emma', 'George', 'Amanda'][Math.random() * 5 | 0],\n    // eslint-disable-line no-bitwise\n    waitingMessage: 'Messages will be delivered when other users arrive',\n    container: '#chat'\n  },\n  screenSharing: {\n    extensionID: 'plocfffmbcclpdifaikiikgplfnepkpo',\n    annotation: true,\n    externalWindow: false,\n    dev: true,\n    screenProperties: {\n      insertMode: 'append',\n      width: '100%',\n      height: '100%',\n      showControls: false,\n      style: {\n        buttonDisplayMode: 'off'\n      },\n      videoSource: 'window',\n      fitMode: 'contain' // Using default\n\n    }\n  },\n  annotation: {\n    absoluteParent: {\n      publisher: '.App-video-container',\n      subscriber: '.App-video-container'\n    }\n  }\n};\n/**\r\n * Build classes for container elements based on state\r\n * @param {Object} state\r\n */\n\nconst containerClasses = state => {\n  const {\n    active,\n    meta,\n    localAudioEnabled,\n    localVideoEnabled\n  } = state;\n  const sharingScreen = meta ? !!meta.publisher.screen : false;\n  const viewingSharedScreen = meta ? meta.subscriber.screen : false;\n  const activeCameraSubscribers = meta ? meta.subscriber.camera : 0;\n  const activeCameraSubscribersGt2 = activeCameraSubscribers > 2;\n  const activeCameraSubscribersOdd = activeCameraSubscribers % 2;\n  const screenshareActive = viewingSharedScreen || sharingScreen;\n  return {\n    controlClass: classNames('App-control-container', {\n      hidden: !active\n    }),\n    localAudioClass: classNames('ots-video-control circle audio', {\n      hidden: !active,\n      muted: !localAudioEnabled\n    }),\n    localVideoClass: classNames('ots-video-control circle video', {\n      hidden: !active,\n      muted: !localVideoEnabled\n    }),\n    localCallClass: classNames('ots-video-control circle end-call', {\n      hidden: !active\n    }),\n    cameraPublisherClass: classNames('video-container', {\n      hidden: !active,\n      small: !!activeCameraSubscribers || screenshareActive,\n      left: screenshareActive\n    }),\n    screenPublisherClass: classNames('video-container', {\n      hidden: !active || !sharingScreen\n    }),\n    cameraSubscriberClass: classNames('video-container', {\n      hidden: !active || !activeCameraSubscribers\n    }, {\n      'active-gt2': activeCameraSubscribersGt2 && !screenshareActive\n    }, {\n      'active-odd': activeCameraSubscribersOdd && !screenshareActive\n    }, {\n      small: screenshareActive\n    }),\n    screenSubscriberClass: classNames('video-container', {\n      hidden: !viewingSharedScreen || !active\n    })\n  };\n};\n\nconst connectingMask = () => /*#__PURE__*/React.createElement(\"div\", {\n  className: \"App-mask\",\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 97,\n    columnNumber: 3\n  }\n}, /*#__PURE__*/React.createElement(Spinner, {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 98,\n    columnNumber: 5\n  }\n}), /*#__PURE__*/React.createElement(\"div\", {\n  className: \"message with-spinner\",\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 99,\n    columnNumber: 5\n  }\n}, \"Connecting\"));\n\nconst startCallMask = start => /*#__PURE__*/React.createElement(\"div\", {\n  className: \"App-mask\",\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 103,\n    columnNumber: 3\n  }\n}, /*#__PURE__*/React.createElement(\"button\", {\n  className: \"message button clickable\",\n  onClick: start,\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 104,\n    columnNumber: 5\n  }\n}, \"Click to Start Call \"));\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      connected: false,\n      active: false,\n      publishers: null,\n      subscribers: null,\n      meta: null,\n      localAudioEnabled: true,\n      localVideoEnabled: true\n    };\n    this.startCall = this.startCall.bind(this);\n    this.endCall = this.endCall.bind(this);\n    this.toggleLocalAudio = this.toggleLocalAudio.bind(this);\n    this.toggleLocalVideo = this.toggleLocalVideo.bind(this);\n  }\n\n  componentDidMount() {\n    otCore = new AccCore(otCoreOptions);\n    otCore.connect().then(() => this.setState({\n      connected: true\n    }));\n    const events = ['subscribeToCamera', 'unsubscribeFromCamera', 'subscribeToScreen', 'unsubscribeFromScreen', 'startScreenShare', 'endScreenShare'];\n    events.forEach(event => otCore.on(event, ({\n      publishers,\n      subscribers,\n      meta\n    }) => {\n      this.setState({\n        publishers,\n        subscribers,\n        meta\n      });\n    }));\n  }\n\n  startCall() {\n    otCore.startCall().then(({\n      publishers,\n      subscribers,\n      meta\n    }) => {\n      this.setState({\n        publishers,\n        subscribers,\n        meta,\n        active: true\n      });\n    }).catch(error => console.log(error));\n  }\n\n  endCall() {\n    otCore.endCall();\n    this.setState({\n      active: false\n    });\n  }\n\n  toggleLocalAudio() {\n    otCore.toggleLocalAudio(!this.state.localAudioEnabled);\n    this.setState({\n      localAudioEnabled: !this.state.localAudioEnabled\n    });\n  }\n\n  toggleLocalVideo() {\n    otCore.toggleLocalVideo(!this.state.localVideoEnabled);\n    this.setState({\n      localVideoEnabled: !this.state.localVideoEnabled\n    });\n  }\n\n  render() {\n    const {\n      connected,\n      active\n    } = this.state;\n    const {\n      localAudioClass,\n      localVideoClass,\n      localCallClass,\n      controlClass,\n      cameraPublisherClass,\n      screenPublisherClass,\n      cameraSubscriberClass,\n      screenSubscriberClass\n    } = containerClasses(this.state);\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"App\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"App-header\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: logo,\n      className: \"App-logo\",\n      alt: \"logo\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 11\n      }\n    }, \"OpenTok Accelerator Core\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"App-main\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"App-video-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 11\n      }\n    }, !connected && connectingMask(), connected && !active && startCallMask(this.startCall), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"cameraPublisherContainer\",\n      className: cameraPublisherClass,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"screenPublisherContainer\",\n      className: screenPublisherClass,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"cameraSubscriberContainer\",\n      className: cameraSubscriberClass,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"screenSubscriberContainer\",\n      className: screenSubscriberClass,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"controls\",\n      className: controlClass,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: localAudioClass,\n      onClick: this.toggleLocalAudio,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: localVideoClass,\n      onClick: this.toggleLocalVideo,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: localCallClass,\n      onClick: this.endCall,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"chat\",\n      className: \"App-chat-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 11\n      }\n    })));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["C:/Users/Windows/Desktop/PROYECTOS/Ejemplos/CONFERENCIAS/accelerator-sample-apps-js/react-sample-app/src/App.js"],"names":["React","Component","Spinner","classNames","AccCore","otCore","otCoreOptions","credentials","apiKey","sessionId","token","streamContainers","pubSub","type","data","stream","publisher","camera","screen","subscriber","controlsContainer","packages","communication","callProperties","textChat","name","Math","random","waitingMessage","container","screenSharing","extensionID","annotation","externalWindow","dev","screenProperties","insertMode","width","height","showControls","style","buttonDisplayMode","videoSource","fitMode","absoluteParent","containerClasses","state","active","meta","localAudioEnabled","localVideoEnabled","sharingScreen","viewingSharedScreen","activeCameraSubscribers","activeCameraSubscribersGt2","activeCameraSubscribersOdd","screenshareActive","controlClass","hidden","localAudioClass","muted","localVideoClass","localCallClass","cameraPublisherClass","small","left","screenPublisherClass","cameraSubscriberClass","screenSubscriberClass","connectingMask","startCallMask","start","App","constructor","props","connected","publishers","subscribers","startCall","bind","endCall","toggleLocalAudio","toggleLocalVideo","componentDidMount","connect","then","setState","events","forEach","event","on","catch","error","console","log","render","logo"],"mappings":"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","sourcesContent":["/* Let CRA handle linting for sample app */\r\nimport React, { Component } from 'react';\r\nimport Spinner from 'react-spinner';\r\nimport classNames from 'classnames';\r\n\r\nimport AccCore from 'opentok-accelerator-core';\r\nimport 'opentok-solutions-css';\r\n\r\nimport logo from './logo.svg';\r\n// import config from './config.json';\r\nimport './App.css';\r\n\r\nlet otCore;\r\nconst otCoreOptions = {\r\n  credentials: {\r\n    apiKey: '46876394',\r\n    sessionId: '1_MX40Njg3NjM5NH5-MTU5NjgwNzk2MTk0Nn5yMzdGcmk3Y3ZyK0YyLzhlckJWc3lYMEx-fg',\r\n    token: 'T1==cGFydG5lcl9pZD00Njg3NjM5NCZzaWc9YjI4OGE2NGUzZTI1OGVhNjBlZTY2NTAyYWNhNzNiMjI3OTBiODU5MjpzZXNzaW9uX2lkPTFfTVg0ME5qZzNOak01Tkg1LU1UVTVOamd3TnprMk1UazBObjV5TXpkR2NtazNZM1p5SzBZeUx6aGxja0pXYzNsWU1FeC1mZyZjcmVhdGVfdGltZT0xNTk2ODA4MDAxJm5vbmNlPTAuMzE3OTIzNjY3NTYwMzQ4NSZyb2xlPXB1Ymxpc2hlciZleHBpcmVfdGltZT0xNTk2ODk0NDAwJmNvbm5lY3Rpb25fZGF0YT1QUlVFQkElMjBERSUyMFYlQzMlOERERU8lMjBDT05GRVJFTkNJQSZpbml0aWFsX2xheW91dF9jbGFzc19saXN0PQ==',\r\n  },\r\n  // A container can either be a query selector or an HTML Element\r\n  streamContainers(pubSub, type, data, stream) {\r\n    return {\r\n      publisher: {\r\n        camera: '#cameraPublisherContainer',\r\n        screen: '#screenPublisherContainer',\r\n      },\r\n      subscriber: {\r\n        camera: '#cameraSubscriberContainer',\r\n        screen: '#screenSubscriberContainer',\r\n      },\r\n    }[pubSub][type];\r\n  },\r\n  controlsContainer: '#controls',\r\n  packages: ['textChat', 'screenSharing', 'annotation'],\r\n  communication: {\r\n    callProperties: null, // Using default\r\n  },\r\n  textChat: {\r\n    name: ['David', 'Paul', 'Emma', 'George', 'Amanda'][Math.random() * 5 | 0], // eslint-disable-line no-bitwise\r\n    waitingMessage: 'Messages will be delivered when other users arrive',\r\n    container: '#chat',\r\n  },\r\n  screenSharing: {\r\n    extensionID: 'plocfffmbcclpdifaikiikgplfnepkpo',\r\n    annotation: true,\r\n    externalWindow: false,\r\n    dev: true,\r\n    screenProperties: {\r\n      insertMode: 'append',\r\n      width: '100%',\r\n      height: '100%',\r\n      showControls: false,\r\n      style: {\r\n        buttonDisplayMode: 'off',\r\n      },\r\n      videoSource: 'window',\r\n      fitMode: 'contain' // Using default\r\n    },\r\n  },\r\n  annotation: {\r\n    absoluteParent: {\r\n      publisher: '.App-video-container',\r\n      subscriber: '.App-video-container'\r\n    }\r\n  },\r\n};\r\n\r\n/**\r\n * Build classes for container elements based on state\r\n * @param {Object} state\r\n */\r\nconst containerClasses = (state) => {\r\n  const { active, meta, localAudioEnabled, localVideoEnabled } = state;\r\n  const sharingScreen = meta ? !!meta.publisher.screen : false;\r\n  const viewingSharedScreen = meta ? meta.subscriber.screen : false;\r\n  const activeCameraSubscribers = meta ? meta.subscriber.camera : 0;\r\n  const activeCameraSubscribersGt2 = activeCameraSubscribers > 2;\r\n  const activeCameraSubscribersOdd = activeCameraSubscribers % 2;\r\n  const screenshareActive = viewingSharedScreen || sharingScreen;\r\n  return {\r\n    controlClass: classNames('App-control-container', { hidden: !active }),\r\n    localAudioClass: classNames('ots-video-control circle audio', { hidden: !active, muted: !localAudioEnabled }),\r\n    localVideoClass: classNames('ots-video-control circle video', { hidden: !active, muted: !localVideoEnabled }),\r\n    localCallClass: classNames('ots-video-control circle end-call', { hidden: !active }),\r\n    cameraPublisherClass: classNames('video-container', { hidden: !active, small: !!activeCameraSubscribers || screenshareActive, left: screenshareActive }),\r\n    screenPublisherClass: classNames('video-container', { hidden: !active || !sharingScreen }),\r\n    cameraSubscriberClass: classNames('video-container', { hidden: !active || !activeCameraSubscribers },\r\n      { 'active-gt2': activeCameraSubscribersGt2 && !screenshareActive },\r\n      { 'active-odd': activeCameraSubscribersOdd && !screenshareActive },\r\n      { small: screenshareActive }\r\n    ),\r\n    screenSubscriberClass: classNames('video-container', { hidden: !viewingSharedScreen || !active }),\r\n  };\r\n};\r\n\r\nconst connectingMask = () =>\r\n  <div className=\"App-mask\">\r\n    <Spinner />\r\n    <div className=\"message with-spinner\">Connecting</div>\r\n  </div>;\r\n\r\nconst startCallMask = start =>\r\n  <div className=\"App-mask\">\r\n    <button className=\"message button clickable\" onClick={start}>Click to Start Call </button>\r\n  </div>;\r\n\r\nclass App extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      connected: false,\r\n      active: false,\r\n      publishers: null,\r\n      subscribers: null,\r\n      meta: null,\r\n      localAudioEnabled: true,\r\n      localVideoEnabled: true,\r\n    };\r\n    this.startCall = this.startCall.bind(this);\r\n    this.endCall = this.endCall.bind(this);\r\n    this.toggleLocalAudio = this.toggleLocalAudio.bind(this);\r\n    this.toggleLocalVideo = this.toggleLocalVideo.bind(this);\r\n  }\r\n\r\n  componentDidMount() {\r\n    otCore = new AccCore(otCoreOptions);\r\n    otCore.connect().then(() => this.setState({ connected: true }));\r\n    const events = [\r\n      'subscribeToCamera',\r\n      'unsubscribeFromCamera',\r\n      'subscribeToScreen',\r\n      'unsubscribeFromScreen',\r\n      'startScreenShare',\r\n      'endScreenShare',\r\n    ];\r\n\r\n    events.forEach(event => otCore.on(event, ({ publishers, subscribers, meta }) => {\r\n      this.setState({ publishers, subscribers, meta });\r\n    }));\r\n  }\r\n\r\n  startCall() {\r\n    otCore.startCall()\r\n      .then(({ publishers, subscribers, meta }) => {\r\n        this.setState({ publishers, subscribers, meta, active: true });\r\n      }).catch(error => console.log(error));\r\n  }\r\n\r\n  endCall() {\r\n    otCore.endCall();\r\n    this.setState({ active: false });\r\n  }\r\n\r\n  toggleLocalAudio() {\r\n    otCore.toggleLocalAudio(!this.state.localAudioEnabled);\r\n    this.setState({ localAudioEnabled: !this.state.localAudioEnabled });\r\n  }\r\n\r\n  toggleLocalVideo() {\r\n    otCore.toggleLocalVideo(!this.state.localVideoEnabled);\r\n    this.setState({ localVideoEnabled: !this.state.localVideoEnabled });\r\n  }\r\n\r\n  render() {\r\n    const { connected, active } = this.state;\r\n    const {\r\n      localAudioClass,\r\n      localVideoClass,\r\n      localCallClass,\r\n      controlClass,\r\n      cameraPublisherClass,\r\n      screenPublisherClass,\r\n      cameraSubscriberClass,\r\n      screenSubscriberClass,\r\n    } = containerClasses(this.state);\r\n\r\n    return (\r\n      <div className=\"App\">\r\n        <div className=\"App-header\">\r\n          <img src={logo} className=\"App-logo\" alt=\"logo\" />\r\n          <h1>OpenTok Accelerator Core</h1>\r\n        </div>\r\n        <div className=\"App-main\">\r\n          <div className=\"App-video-container\">\r\n            { !connected && connectingMask() }\r\n            { connected && !active && startCallMask(this.startCall)}\r\n            <div id=\"cameraPublisherContainer\" className={cameraPublisherClass} />\r\n            <div id=\"screenPublisherContainer\" className={screenPublisherClass} />\r\n            <div id=\"cameraSubscriberContainer\" className={cameraSubscriberClass} />\r\n            <div id=\"screenSubscriberContainer\" className={screenSubscriberClass} />\r\n          </div>\r\n          <div id=\"controls\" className={controlClass}>\r\n            <div className={localAudioClass} onClick={this.toggleLocalAudio} />\r\n            <div className={localVideoClass} onClick={this.toggleLocalVideo} />\r\n            <div className={localCallClass} onClick={this.endCall} />\r\n          </div>\r\n          <div id=\"chat\" className=\"App-chat-container\" />\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default App;\r\n"]},"metadata":{},"sourceType":"module"}